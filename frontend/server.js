const express = require('express');
const bodyParser = require('body-parser');

const app = express();
const port = process.env.PORT || 5000;

app.use(bodyParser.json());
app.use(bodyParser.urlencoded({ extended: true }));

app.get('/api/hello', (req, res) => {
    res.send({ express: 'Hello From Express' });
});

app.get('/shards', (req,res) =>{
    const shards = [{"name":"shard1","replicas":[{"CPU":95,"host":"solr-1","leader":true,"replica":"Test_shard1_replica1","state":"active"},{"CPU":95,"host":"solr-2","leader":false,"replica":"Test_shard1_replica2","state":"active"}]},{"name":"shard2","replicas":[{"CPU":95,"host":"solr-1","leader":true,"replica":"Test_shard2_replica1","state":"active"},{"CPU":95,"host":"solr-2","leader":false,"replica":"Test_shard2_replica2","state":"active"}]},{"name":"shard3","replicas":[{"CPU":95,"host":"solr-1","leader":true,"replica":"Test_shard3_replica1","state":"active"},{"CPU":95,"host":"solr-2","leader":false,"replica":"Test_shard3_replica2","state":"active"}]},{"name":"shard4","replicas":[{"CPU":95,"host":"solr-1","leader":true,"replica":"Test_shard4_replica1","state":"active"},{"CPU":95,"host":"solr-2","leader":false,"replica":"Test_shard4_replica2","state":"active"}]},{"name":"shard5","replicas":[{"CPU":95,"host":"solr-1","leader":true,"replica":"Test_shard5_replica1","state":"active"},{"CPU":95,"host":"solr-2","leader":false,"replica":"Test_shard5_replica2","state":"active"}]},{"name":"shard6","replicas":[{"CPU":95,"host":"solr-1","leader":true,"replica":"Test_shard6_replica1","state":"active"},{"CPU":95,"host":"solr-2","leader":false,"replica":"Test_shard6_replica2","state":"active"}]},{"name":"shard7","replicas":[{"CPU":95,"host":"solr-1","leader":true,"replica":"Test_shard7_replica1","state":"active"},{"CPU":95,"host":"solr-2","leader":false,"replica":"Test_shard7_replica2","state":"active"}]},{"name":"shard8","replicas":[{"CPU":95,"host":"solr-1","leader":true,"replica":"Test_shard8_replica1","state":"active"},{"CPU":95,"host":"solr-2","leader":false,"replica":"Test_shard8_replica2","state":"active"}]},{"name":"shard9","replicas":[{"CPU":95,"host":"solr-1","leader":true,"replica":"Test_shard9_replica1","state":"active"},{"CPU":95,"host":"solr-2","leader":false,"replica":"Test_shard9_replica2","state":"active"}]},{"name":"shard10","replicas":[{"CPU":95,"host":"solr-1","leader":true,"replica":"Test_shard10_replica1","state":"active"},{"CPU":95,"host":"solr-2","leader":false,"replica":"Test_shard10_replica2","state":"active"}]},{"name":"shard11","replicas":[{"CPU":95,"host":"solr-1","leader":true,"replica":"Test_shard11_replica1","state":"active"},{"CPU":95,"host":"solr-2","leader":false,"replica":"Test_shard11_replica2","state":"active"}]},{"name":"shard12","replicas":[{"CPU":95,"host":"solr-1","leader":true,"replica":"Test_shard12_replica1","state":"active"},{"CPU":95,"host":"solr-2","leader":false,"replica":"Test_shard12_replica2","state":"active"}]},{"name":"shard13","replicas":[{"CPU":95,"host":"solr-1","leader":true,"replica":"Test_shard13_replica1","state":"active"},{"CPU":95,"host":"solr-2","leader":false,"replica":"Test_shard13_replica2","state":"active"}]},{"name":"shard14","replicas":[{"CPU":95,"host":"solr-1","leader":true,"replica":"Test_shard14_replica1","state":"active"},{"CPU":95,"host":"solr-2","leader":false,"replica":"Test_shard14_replica2","state":"active"}]},{"name":"shard15","replicas":[{"CPU":95,"host":"solr-1","leader":true,"replica":"Test_shard15_replica1","state":"active"},{"CPU":95,"host":"solr-2","leader":false,"replica":"Test_shard15_replica2","state":"active"}]},{"name":"shard16","replicas":[{"CPU":95,"host":"solr-1","leader":true,"replica":"Test_shard16_replica1","state":"active"},{"CPU":95,"host":"solr-2","leader":false,"replica":"Test_shard16_replica2","state":"active"}]},{"name":"shard17","replicas":[{"CPU":95,"host":"solr-1","leader":true,"replica":"Test_shard17_replica1","state":"active"},{"CPU":95,"host":"solr-2","leader":false,"replica":"Test_shard17_replica2","state":"active"}]},{"name":"shard18","replicas":[{"CPU":95,"host":"solr-1","leader":true,"replica":"Test_shard18_replica1","state":"active"},{"CPU":95,"host":"solr-2","leader":false,"replica":"Test_shard18_replica2","state":"active"}]},{"name":"shard19","replicas":[{"CPU":95,"host":"solr-1","leader":true,"replica":"Test_shard19_replica1","state":"active"},{"CPU":95,"host":"solr-2","leader":false,"replica":"Test_shard19_replica2","state":"active"}]},{"name":"shard20","replicas":[{"CPU":95,"host":"solr-1","leader":true,"replica":"Test_shard20_replica1","state":"active"},{"CPU":95,"host":"solr-2","leader":false,"replica":"Test_shard20_replica2","state":"active"}]},{"name":"shard21","replicas":[{"CPU":95,"host":"solr-1","leader":true,"replica":"Test_shard21_replica1","state":"active"},{"CPU":95,"host":"solr-2","leader":false,"replica":"Test_shard21_replica2","state":"active"}]},{"name":"shard22","replicas":[{"CPU":95,"host":"solr-1","leader":true,"replica":"Test_shard22_replica1","state":"active"},{"CPU":95,"host":"solr-2","leader":false,"replica":"Test_shard22_replica2","state":"active"}]},{"name":"shard23","replicas":[{"CPU":95,"host":"solr-1","leader":true,"replica":"Test_shard23_replica1","state":"active"},{"CPU":95,"host":"solr-2","leader":false,"replica":"Test_shard23_replica2","state":"active"}]},{"name":"shard24","replicas":[{"CPU":95,"host":"solr-1","leader":true,"replica":"Test_shard24_replica1","state":"active"},{"CPU":95,"host":"solr-2","leader":false,"replica":"Test_shard24_replica2","state":"active"}]},{"name":"shard25","replicas":[{"CPU":95,"host":"solr-1","leader":true,"replica":"Test_shard25_replica1","state":"active"},{"CPU":95,"host":"solr-2","leader":false,"replica":"Test_shard25_replica2","state":"active"}]},{"name":"shard26","replicas":[{"CPU":95,"host":"solr-1","leader":true,"replica":"Test_shard26_replica1","state":"active"},{"CPU":95,"host":"solr-2","leader":false,"replica":"Test_shard26_replica2","state":"active"}]},{"name":"shard27","replicas":[{"CPU":95,"host":"solr-1","leader":true,"replica":"Test_shard27_replica1","state":"active"},{"CPU":95,"host":"solr-2","leader":false,"replica":"Test_shard27_replica2","state":"active"}]},{"name":"shard28","replicas":[{"CPU":95,"host":"solr-1","leader":true,"replica":"Test_shard28_replica1","state":"active"},{"CPU":95,"host":"solr-2","leader":false,"replica":"Test_shard28_replica2","state":"active"}]},{"name":"shard29","replicas":[{"CPU":95,"host":"solr-1","leader":true,"replica":"Test_shard29_replica1","state":"active"},{"CPU":95,"host":"solr-2","leader":false,"replica":"Test_shard29_replica2","state":"active"}]},{"name":"shard30","replicas":[{"CPU":95,"host":"solr-1","leader":true,"replica":"Test_shard30_replica1","state":"active"},{"CPU":95,"host":"solr-2","leader":false,"replica":"Test_shard30_replica2","state":"active"}]},{"name":"shard31","replicas":[{"CPU":95,"host":"solr-1","leader":true,"replica":"Test_shard31_replica1","state":"active"},{"CPU":95,"host":"solr-2","leader":false,"replica":"Test_shard31_replica2","state":"active"}]},{"name":"shard32","replicas":[{"CPU":95,"host":"solr-1","leader":true,"replica":"Test_shard32_replica1","state":"active"},{"CPU":95,"host":"solr-2","leader":false,"replica":"Test_shard32_replica2","state":"active"}]},{"name":"shard33","replicas":[{"CPU":95,"host":"solr-1","leader":true,"replica":"Test_shard33_replica1","state":"active"},{"CPU":95,"host":"solr-2","leader":false,"replica":"Test_shard33_replica2","state":"active"}]},{"name":"shard34","replicas":[{"CPU":95,"host":"solr-1","leader":true,"replica":"Test_shard34_replica1","state":"active"},{"CPU":95,"host":"solr-2","leader":false,"replica":"Test_shard34_replica2","state":"active"}]},{"name":"shard35","replicas":[{"CPU":95,"host":"solr-1","leader":true,"replica":"Test_shard35_replica1","state":"active"},{"CPU":95,"host":"solr-2","leader":false,"replica":"Test_shard35_replica2","state":"active"}]},{"name":"shard36","replicas":[{"CPU":95,"host":"solr-1","leader":true,"replica":"Test_shard36_replica1","state":"active"},{"CPU":95,"host":"solr-2","leader":false,"replica":"Test_shard36_replica2","state":"active"}]},{"name":"shard37","replicas":[{"CPU":95,"host":"solr-1","leader":true,"replica":"Test_shard37_replica1","state":"active"},{"CPU":95,"host":"solr-2","leader":false,"replica":"Test_shard37_replica2","state":"active"}]},{"name":"shard38","replicas":[{"CPU":95,"host":"solr-1","leader":true,"replica":"Test_shard38_replica1","state":"active"},{"CPU":95,"host":"solr-2","leader":false,"replica":"Test_shard38_replica2","state":"active"}]},{"name":"shard39","replicas":[{"CPU":95,"host":"solr-1","leader":true,"replica":"Test_shard39_replica1","state":"active"},{"CPU":95,"host":"solr-2","leader":false,"replica":"Test_shard39_replica2","state":"active"}]},{"name":"shard40","replicas":[{"CPU":95,"host":"solr-1","leader":true,"replica":"Test_shard40_replica1","state":"active"},{"CPU":95,"host":"solr-2","leader":false,"replica":"Test_shard40_replica2","state":"active"}]},{"name":"shard41","replicas":[{"CPU":95,"host":"solr-1","leader":true,"replica":"Test_shard41_replica1","state":"active"},{"CPU":95,"host":"solr-2","leader":false,"replica":"Test_shard41_replica2","state":"active"}]},{"name":"shard42","replicas":[{"CPU":95,"host":"solr-1","leader":true,"replica":"Test_shard42_replica1","state":"active"},{"CPU":95,"host":"solr-2","leader":false,"replica":"Test_shard42_replica2","state":"active"}]},{"name":"shard43","replicas":[{"CPU":95,"host":"solr-1","leader":true,"replica":"Test_shard43_replica1","state":"active"},{"CPU":95,"host":"solr-2","leader":false,"replica":"Test_shard43_replica2","state":"active"}]},{"name":"shard44","replicas":[{"CPU":95,"host":"solr-1","leader":true,"replica":"Test_shard44_replica1","state":"active"},{"CPU":95,"host":"solr-2","leader":false,"replica":"Test_shard44_replica2","state":"active"}]},{"name":"shard45","replicas":[{"CPU":95,"host":"solr-1","leader":true,"replica":"Test_shard45_replica1","state":"active"},{"CPU":95,"host":"solr-2","leader":false,"replica":"Test_shard45_replica2","state":"active"}]},{"name":"shard46","replicas":[{"CPU":95,"host":"solr-1","leader":true,"replica":"Test_shard46_replica1","state":"active"},{"CPU":95,"host":"solr-2","leader":false,"replica":"Test_shard46_replica2","state":"active"}]},{"name":"shard47","replicas":[{"CPU":95,"host":"solr-1","leader":true,"replica":"Test_shard47_replica1","state":"active"},{"CPU":95,"host":"solr-2","leader":false,"replica":"Test_shard47_replica2","state":"active"}]},{"name":"shard48","replicas":[{"CPU":95,"host":"solr-1","leader":true,"replica":"Test_shard48_replica1","state":"active"},{"CPU":95,"host":"solr-2","leader":false,"replica":"Test_shard48_replica2","state":"active"}]},{"name":"shard49","replicas":[{"CPU":95,"host":"solr-1","leader":true,"replica":"Test_shard49_replica1","state":"active"},{"CPU":95,"host":"solr-2","leader":false,"replica":"Test_shard49_replica2","state":"active"}]},{"name":"shard50","replicas":[{"CPU":95,"host":"solr-1","leader":true,"replica":"Test_shard50_replica1","state":"active"},{"CPU":95,"host":"solr-2","leader":false,"replica":"Test_shard50_replica2","state":"active"}]},{"name":"shard51","replicas":[{"CPU":95,"host":"solr-1","leader":true,"replica":"Test_shard51_replica1","state":"active"},{"CPU":95,"host":"solr-2","leader":false,"replica":"Test_shard51_replica2","state":"active"}]},{"name":"shard52","replicas":[{"CPU":95,"host":"solr-1","leader":true,"replica":"Test_shard52_replica1","state":"active"},{"CPU":95,"host":"solr-2","leader":false,"replica":"Test_shard52_replica2","state":"active"}]},{"name":"shard53","replicas":[{"CPU":95,"host":"solr-1","leader":true,"replica":"Test_shard53_replica1","state":"active"},{"CPU":95,"host":"solr-2","leader":false,"replica":"Test_shard53_replica2","state":"active"}]},{"name":"shard54","replicas":[{"CPU":95,"host":"solr-1","leader":true,"replica":"Test_shard54_replica1","state":"active"},{"CPU":95,"host":"solr-2","leader":false,"replica":"Test_shard54_replica2","state":"active"}]},{"name":"shard55","replicas":[{"CPU":95,"host":"solr-1","leader":true,"replica":"Test_shard55_replica1","state":"active"},{"CPU":95,"host":"solr-2","leader":false,"replica":"Test_shard55_replica2","state":"active"}]},{"name":"shard56","replicas":[{"CPU":95,"host":"solr-1","leader":true,"replica":"Test_shard56_replica1","state":"active"},{"CPU":95,"host":"solr-2","leader":false,"replica":"Test_shard56_replica2","state":"active"}]},{"name":"shard57","replicas":[{"CPU":95,"host":"solr-1","leader":true,"replica":"Test_shard57_replica1","state":"active"},{"CPU":95,"host":"solr-2","leader":false,"replica":"Test_shard57_replica2","state":"active"}]},{"name":"shard58","replicas":[{"CPU":95,"host":"solr-1","leader":true,"replica":"Test_shard58_replica1","state":"active"},{"CPU":95,"host":"solr-2","leader":false,"replica":"Test_shard58_replica2","state":"active"}]},{"name":"shard59","replicas":[{"CPU":95,"host":"solr-1","leader":true,"replica":"Test_shard59_replica1","state":"active"},{"CPU":95,"host":"solr-2","leader":false,"replica":"Test_shard59_replica2","state":"active"}]},{"name":"shard60","replicas":[{"CPU":95,"host":"solr-1","leader":true,"replica":"Test_shard60_replica1","state":"active"},{"CPU":95,"host":"solr-2","leader":false,"replica":"Test_shard60_replica2","state":"active"}]},{"name":"shard61","replicas":[{"CPU":95,"host":"solr-1","leader":true,"replica":"Test_shard61_replica1","state":"active"},{"CPU":95,"host":"solr-2","leader":false,"replica":"Test_shard61_replica2","state":"active"}]},{"name":"shard62","replicas":[{"CPU":95,"host":"solr-1","leader":true,"replica":"Test_shard62_replica1","state":"active"},{"CPU":95,"host":"solr-2","leader":false,"replica":"Test_shard62_replica2","state":"active"}]},{"name":"shard63","replicas":[{"CPU":95,"host":"solr-1","leader":true,"replica":"Test_shard63_replica1","state":"active"},{"CPU":95,"host":"solr-2","leader":false,"replica":"Test_shard63_replica2","state":"active"}]},{"name":"shard64","replicas":[{"CPU":95,"host":"solr-1","leader":true,"replica":"Test_shard64_replica1","state":"active"},{"CPU":95,"host":"solr-2","leader":false,"replica":"Test_shard64_replica2","state":"active"}]},{"name":"shard65","replicas":[{"CPU":95,"host":"solr-1","leader":true,"replica":"Test_shard65_replica1","state":"active"},{"CPU":95,"host":"solr-2","leader":false,"replica":"Test_shard65_replica2","state":"active"}]},{"name":"shard66","replicas":[{"CPU":95,"host":"solr-1","leader":true,"replica":"Test_shard66_replica1","state":"active"},{"CPU":95,"host":"solr-2","leader":false,"replica":"Test_shard66_replica2","state":"active"}]},{"name":"shard67","replicas":[{"CPU":95,"host":"solr-1","leader":true,"replica":"Test_shard67_replica1","state":"active"},{"CPU":95,"host":"solr-2","leader":false,"replica":"Test_shard67_replica2","state":"active"}]},{"name":"shard68","replicas":[{"CPU":95,"host":"solr-1","leader":true,"replica":"Test_shard68_replica1","state":"active"},{"CPU":95,"host":"solr-2","leader":false,"replica":"Test_shard68_replica2","state":"active"}]},{"name":"shard69","replicas":[{"CPU":95,"host":"solr-1","leader":true,"replica":"Test_shard69_replica1","state":"active"},{"CPU":95,"host":"solr-2","leader":false,"replica":"Test_shard69_replica2","state":"active"}]},{"name":"shard70","replicas":[{"CPU":95,"host":"solr-1","leader":true,"replica":"Test_shard70_replica1","state":"active"},{"CPU":95,"host":"solr-2","leader":false,"replica":"Test_shard70_replica2","state":"active"}]},{"name":"shard71","replicas":[{"CPU":95,"host":"solr-1","leader":true,"replica":"Test_shard71_replica1","state":"active"},{"CPU":95,"host":"solr-2","leader":false,"replica":"Test_shard71_replica2","state":"active"}]},{"name":"shard72","replicas":[{"CPU":95,"host":"solr-1","leader":true,"replica":"Test_shard72_replica1","state":"active"},{"CPU":95,"host":"solr-2","leader":false,"replica":"Test_shard72_replica2","state":"active"}]},{"name":"shard73","replicas":[{"CPU":95,"host":"solr-1","leader":true,"replica":"Test_shard73_replica1","state":"active"},{"CPU":95,"host":"solr-2","leader":false,"replica":"Test_shard73_replica2","state":"active"}]},{"name":"shard74","replicas":[{"CPU":95,"host":"solr-1","leader":true,"replica":"Test_shard74_replica1","state":"active"},{"CPU":95,"host":"solr-2","leader":false,"replica":"Test_shard74_replica2","state":"active"}]},{"name":"shard75","replicas":[{"CPU":95,"host":"solr-1","leader":true,"replica":"Test_shard75_replica1","state":"active"},{"CPU":95,"host":"solr-2","leader":false,"replica":"Test_shard75_replica2","state":"active"}]},{"name":"shard76","replicas":[{"CPU":95,"host":"solr-1","leader":true,"replica":"Test_shard76_replica1","state":"active"},{"CPU":95,"host":"solr-2","leader":false,"replica":"Test_shard76_replica2","state":"active"}]},{"name":"shard77","replicas":[{"CPU":95,"host":"solr-1","leader":true,"replica":"Test_shard77_replica1","state":"active"},{"CPU":95,"host":"solr-2","leader":false,"replica":"Test_shard77_replica2","state":"active"}]},{"name":"shard78","replicas":[{"CPU":95,"host":"solr-1","leader":true,"replica":"Test_shard78_replica1","state":"active"},{"CPU":95,"host":"solr-2","leader":false,"replica":"Test_shard78_replica2","state":"active"}]},{"name":"shard79","replicas":[{"CPU":95,"host":"solr-1","leader":true,"replica":"Test_shard79_replica1","state":"active"},{"CPU":95,"host":"solr-2","leader":false,"replica":"Test_shard79_replica2","state":"active"}]},{"name":"shard80","replicas":[{"CPU":95,"host":"solr-1","leader":true,"replica":"Test_shard80_replica1","state":"active"},{"CPU":95,"host":"solr-2","leader":false,"replica":"Test_shard80_replica2","state":"active"}]},{"name":"shard81","replicas":[{"CPU":95,"host":"solr-1","leader":true,"replica":"Test_shard81_replica1","state":"active"},{"CPU":95,"host":"solr-2","leader":false,"replica":"Test_shard81_replica2","state":"active"}]},{"name":"shard82","replicas":[{"CPU":95,"host":"solr-1","leader":true,"replica":"Test_shard82_replica1","state":"active"},{"CPU":95,"host":"solr-2","leader":false,"replica":"Test_shard82_replica2","state":"active"}]},{"name":"shard83","replicas":[{"CPU":95,"host":"solr-1","leader":true,"replica":"Test_shard83_replica1","state":"active"},{"CPU":95,"host":"solr-2","leader":false,"replica":"Test_shard83_replica2","state":"active"}]},{"name":"shard84","replicas":[{"CPU":95,"host":"solr-1","leader":true,"replica":"Test_shard84_replica1","state":"active"},{"CPU":95,"host":"solr-2","leader":false,"replica":"Test_shard84_replica2","state":"active"}]},{"name":"shard85","replicas":[{"CPU":95,"host":"solr-1","leader":true,"replica":"Test_shard85_replica1","state":"active"},{"CPU":95,"host":"solr-2","leader":false,"replica":"Test_shard85_replica2","state":"active"}]},{"name":"shard86","replicas":[{"CPU":95,"host":"solr-1","leader":true,"replica":"Test_shard86_replica1","state":"active"},{"CPU":95,"host":"solr-2","leader":false,"replica":"Test_shard86_replica2","state":"active"}]},{"name":"shard87","replicas":[{"CPU":95,"host":"solr-1","leader":true,"replica":"Test_shard87_replica1","state":"active"},{"CPU":95,"host":"solr-2","leader":false,"replica":"Test_shard87_replica2","state":"active"}]},{"name":"shard88","replicas":[{"CPU":95,"host":"solr-1","leader":true,"replica":"Test_shard88_replica1","state":"active"},{"CPU":95,"host":"solr-2","leader":false,"replica":"Test_shard88_replica2","state":"active"}]},{"name":"shard89","replicas":[{"CPU":95,"host":"solr-1","leader":true,"replica":"Test_shard89_replica1","state":"active"},{"CPU":95,"host":"solr-2","leader":false,"replica":"Test_shard89_replica2","state":"active"}]},{"name":"shard90","replicas":[{"CPU":95,"host":"solr-1","leader":true,"replica":"Test_shard90_replica1","state":"active"},{"CPU":95,"host":"solr-2","leader":false,"replica":"Test_shard90_replica2","state":"active"}]},{"name":"shard91","replicas":[{"CPU":95,"host":"solr-1","leader":true,"replica":"Test_shard91_replica1","state":"active"},{"CPU":95,"host":"solr-2","leader":false,"replica":"Test_shard91_replica2","state":"active"}]},{"name":"shard92","replicas":[{"CPU":95,"host":"solr-1","leader":true,"replica":"Test_shard92_replica1","state":"active"},{"CPU":95,"host":"solr-2","leader":false,"replica":"Test_shard92_replica2","state":"active"}]},{"name":"shard93","replicas":[{"CPU":95,"host":"solr-1","leader":true,"replica":"Test_shard93_replica1","state":"active"},{"CPU":95,"host":"solr-2","leader":false,"replica":"Test_shard93_replica2","state":"active"}]},{"name":"shard94","replicas":[{"CPU":95,"host":"solr-1","leader":true,"replica":"Test_shard94_replica1","state":"active"},{"CPU":95,"host":"solr-2","leader":false,"replica":"Test_shard94_replica2","state":"active"}]},{"name":"shard95","replicas":[{"CPU":95,"host":"solr-1","leader":true,"replica":"Test_shard95_replica1","state":"active"},{"CPU":95,"host":"solr-2","leader":false,"replica":"Test_shard95_replica2","state":"active"}]},{"name":"shard96","replicas":[{"CPU":95,"host":"solr-1","leader":true,"replica":"Test_shard96_replica1","state":"active"},{"CPU":95,"host":"solr-2","leader":false,"replica":"Test_shard96_replica2","state":"active"}]},{"name":"shard97","replicas":[{"CPU":95,"host":"solr-1","leader":true,"replica":"Test_shard97_replica1","state":"active"},{"CPU":95,"host":"solr-2","leader":false,"replica":"Test_shard97_replica2","state":"active"}]},{"name":"shard98","replicas":[{"CPU":95,"host":"solr-1","leader":true,"replica":"Test_shard98_replica1","state":"active"},{"CPU":95,"host":"solr-2","leader":false,"replica":"Test_shard98_replica2","state":"active"}]},{"name":"shard99","replicas":[{"CPU":95,"host":"solr-1","leader":true,"replica":"Test_shard99_replica1","state":"active"},{"CPU":95,"host":"solr-2","leader":false,"replica":"Test_shard99_replica2","state":"active"}]},{"name":"shard100","replicas":[{"CPU":95,"host":"solr-1","leader":true,"replica":"Test_shard100_replica1","state":"active"},{"CPU":95,"host":"solr-2","leader":false,"replica":"Test_shard100_replica2","state":"active"}]}];
    res.send(shards);
});

app.get('/collections', (req,res) => {
    const collections = ["OZ0598","IZ0194","NZ1066"];
    res.send(collections);
});

app.post('/logger', (req, res) => {
    console.log(req.body);

    run(req.body["logs"]).catch(console.log);
    res.send(
        `I received your POST request. This is what you sent me: ${req.body.post}`,
    );
});

async function run (dataset) {
    const { Client } = require('@elastic/elasticsearch');
    const client = new Client({ node: 'http://3.20.125.90:9200' });
    const body = dataset.flatMap(doc => [{ index: { _index: 'sc2' } }, doc]);

    const { body: bulkResponse } = await client.bulk({ refresh: true, body });

    if (bulkResponse.errors) {
        const erroredDocuments = [];
        // The items array has the same order of the dataset we just indexed.
        // The presence of the `error` key indicates that the operation
        // that we did for the document has failed.
        bulkResponse.items.forEach((action, i) => {
            const operation = Object.keys(action)[0];
            if (action[operation].error) {
                erroredDocuments.push({
                    // If the status is 429 it means that you can retry the document,
                    // otherwise it's very likely a mapping error, and you should
                    // fix the document before to try it again.
                    status: action[operation].status,
                    error: action[operation].error,
                    operation: body[i * 2],
                    document: body[i * 2 + 1]
                })
            }
        });
        console.log(erroredDocuments)
    }

    const { body: count } = await client.count({ index: 'sc2' });
    console.log(count)
}



app.listen(port, () => console.log(`Listening on port ${port}`));